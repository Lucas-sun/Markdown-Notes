**目录**
- [python异步编程](#python异步编程)
    - [同步异步的区别](#同步异步的区别)
    - [异步和多线程的区别](#异步和多线程的区别)
    - [async和await](#async和await)
    - [线程安全](#线程安全)
# python异步编程
### 同步异步的区别
- 同步
  1. 在同步编程中，代码按照顺序逐行执行，每一行代码都会等待上一行代码执行完毕后再执行。
  2. 当遇到耗时操作（例如网络请求、文件读写等）时，程序会被阻塞，直到操作完成才继续执行下一行代码。
  3. 同步编程易于理解和调试，但可能导致程序在等待IO等操作时浪费时间。
- 异步
  1. 在异步编程中，代码的执行不会被阻塞，可以在等待某些操作完成时执行其他任务。
  2. 通过使用async和await关键字，可以定义异步函数，这样在执行到异步操作时，程序可以切换到其他任务而不等待异步操作完成。
  3. 异步编程通常用于处理大量IO密集型任务，如网络通信、数据库访问等。
### 异步和多线程的区别
1. 并发模型
   - **异步编程**： 通过使用事件循环和非阻塞的I/O操作，异步编程允许在单线程中处理多个任务。程序可以在等待某个任务完成时继续执行其他任务，而不会阻塞整个线程。
   - **多线程**： 多线程是通过创建多个线程来同时执行不同的任务。每个线程都有自己的执行流，但它们共享进程的资源。多线程可以并行执行，但需要注意线程同步和竞态条件的问题。
2. 性能
   - **异步编程**： 主要用于处理I/O密集型任务，例如网络请求、数据库查询等。由于可以在等待I/O时执行其他任务，异步编程在提高程序响应性和效率方面表现出色。
   - **多线程**： 主要用于处理CPU密集型任务，例如大量计算。多线程可以利用多个CPU核心并行执行任务，提高整体计算能力。
3. 资源开销
   - **异步编程**： 通常比多线程更轻量，因为它在单线程中处理多个任务，避免了多线程中的线程切换开销。
   - **多线程**： 创建和管理多个线程会带来一些额外的开销，同时需要考虑线程同步的复杂性。
4. 线程安全和同步
   - **异步编程**： 通常不涉及共享状态，因此在很大程度上避免了多线程中的同步和锁问题。但在某些情况下，可能需要考虑协程之间的同步。
   - **多线程**： 多线程需要处理共享资源时，需要考虑线程安全性和使用锁等机制来防止竞态条件。
### async和await
1. async
   - async 被用于定义异步函数（协程函数）。异步函数使用 async def 来声明。
   - 异步函数可以包含 await 关键字，表明在该点可以挂起该协程的执行，让事件循环（event loop）执行其他任务，从而实现非阻塞的异步操作。
2. await
   - await 通常用于等待一个异步操作的完成。它只能在异步函数中使用。
   - 当遇到 await 关键字时，协程会在此处暂停执行，让事件循环去执行其他任务，直到等待的异步操作完成后再继续执行协程。
### 线程安全
- 我们都知道在mysql中有"原子操作"的概念，比如说A给B一百块钱，B应该返回给A五十元，如果因为某些意外情况导致B没有给A五十，这对于计算机来说是灾难性的，应该预防这种情况的发生，把这两个动作合成一个事务，这个事务执行过程中发生了错误，那么整个事务就应该回滚到最初状态，当作什么事也没发生，这种操作就叫做原子操作
- 在python多线程中，变量是共享的，这是相较于多进程的优点，但当多个CPU参与多个线程的活动时，也会引起结果无法预测的问题，也就是说python的多线程并不安全